**Purpose:**

To create an animation using GeoServer that employs the time dimension capability of a layer, while pulling data from a PostGIS database. The final result is a gif created through a get map request, showing the change of a selected attribute over time.

+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Step** | **Major Activity**                                                                                                                                                                                                                                                                                                                                                                                                                           | **References, Forms and Details**                                                                                                                                                                                                                                                                                                |
+:========:+==============================================================================================================================================================================================================================================================================================================================================================================================================================================+==================================================================================================================================================================================================================================================================================================================================+
| **1**    | In GeoServer create an appropriately named *workspace* with WMS services enabled.                                                                                                                                                                                                                                                                                                                                                            | -Documentation on GeoServer processes, such as creating workspaces, can be found at the official GeoServer website:                                                                                                                                                                                                              |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - http://docs.geoserver.org/latest/en/user/index.html                                                                                                                                                                                                                                                                            |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2**    | Create a new *store* from a PostGIS data source in GeoServer and call it the same thing as the PostGIS table from which it is pulling. (If you do not have a PostGIS table with a time enabled date column follow steps 2a and 2b, otherwise proceed to step 3.)                                                                                                                                                                             | - Mandatory fields to fill for the new *store* are:                                                                                                                                                                                                                                                                              |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          | \*Alternatively a *store* can be created from a shapefile instead of a PostGIS table, as long as there is a column of type 'date'.                                                                                                                                                                                                                                                                                                           |   - Workspace                                                                                                                                                                                                                                                                                                                    |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - dbtype                                                                                                                                                                                                                                                                                                                       |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - host                                                                                                                                                                                                                                                                                                                         |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - port                                                                                                                                                                                                                                                                                                                         |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - database                                                                                                                                                                                                                                                                                                                     |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - schema                                                                                                                                                                                                                                                                                                                       |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - user                                                                                                                                                                                                                                                                                                                         |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |   - passwd                                                                                                                                                                                                                                                                                                                       |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2.a**  | If you are starting from a points shapefile with date information, the date column must be of type 'date'.                                                                                                                                                                                                                                                                                                                                   | - This is necessary information for GeoServer's WMS Animator .                                                                                                                                                                                                                                                                   |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - A 'date' field can be created using the field calculator in ArcGIS and QGIS.                                                                                                                                                                                                                                                   |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2.b**  | Your shapefile can be then be imported into a spatially enabled PostGIS database through the command line.                                                                                                                                                                                                                                                                                                                                   | -View the following website to see the necessary command:                                                                                                                                                                                                                                                                        |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - http://suite.opengeo.org/docs/latest/dataadmin/pgGettingStarted/shp2pgsql.html                                                                                                                                                                                                                                                 |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **3**    | If the PostGIS table was successfully connected through the new store, the option to publish the desired table will become an option. Publish the layer, name it something appropriate and set the Declared SRS to EPSG:4326. For the bounding box select 'compute from data' and 'compute from native bounds'. Under the *Dimensions* tab of the layer, enable Time, set the *Attribute* to the date column and the *Presentation* to List. | - The time dimension will only be allowed to be enabled as long as the PostGIS table or shapefile has a column of type 'date'.                                                                                                                                                                                                   |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **4**    | Test that your layer is working by selecting it in *layer preview*. Select a point to see its attributes. If the layer is not showing refer back to the previous steps, using the GeoServer website for more in depth information.                                                                                                                                                                                                           | -Official GeoServer website:                                                                                                                                                                                                                                                                                                     |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - http://docs.geoserver.org/latest/en/user/index.html                                                                                                                                                                                                                                                                            |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **5**    | Create a store and layer for the raster or vector layer you wish to use as a basemap in the animation. Follow the same procedure for the coordinate system and bounding box.                                                                                                                                                                                                                                                                 | - Rather than a PostGIS table it may be a shapefile.                                                                                                                                                                                                                                                                             |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - Dimensions do not have to be set.                                                                                                                                                                                                                                                                                              |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **6**    | In GeoServer, create the *style* you wish to use for the animation. The style should be selected based on what you think the best way to represent the data is. The GeoServer website provides a range of examples. Set the format to SLD (or download the YSLD extension for simplified coding), and alter the selected styles color ramp and attributes as needed.                                                                         | - Examples of styles include rendering transformations (Barnes Surface, Heatmaps) and categorize.                                                                                                                                                                                                                                |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - Rendering transformations - <http://docs.geoserver.org/2.2.0/user/styling/sld-extensions/rendering-transform.html>                                                                                                                                                                                                             |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - Categorize - http://docs.geoserver.org/2.3.2/user/styling/sld-tipstricks/transformation-func.html                                                                                                                                                                                                                              |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **7**    | Create an appropriately named *Layer Group*. Add the layer with the attributes of interest and set its style to the one you have created. Add the basemap layer and compute the bounding box as with the individual layers.                                                                                                                                                                                                                  | - If you want the styled layer to appear below the basemap, ensure the basemap is at the bottom of the drawing order.                                                                                                                                                                                                            |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **8**    | Use *layer preview* to test that your layer group is rendered effectively.                                                                                                                                                                                                                                                                                                                                                                   | -The time dimension can be tested by adding '&time=' with a date, year or month at the end of the layer preview url.                                                                                                                                                                                                             |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - Ex/ &time=1989                                                                                                                                                                                                                                                                                                                 |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **9**    | In order to add layout elements such as a title, legend and scale to the animation, a layout xml file has to be created. If using an independent version of GeoServer, the layout xml folder goes in the 'layouts' sub-directory. If using a version of GeoServer bundled with GeoNetwork, create a layouts folder in the 'data' sub-directory of GeoServer.                                                                                 | -For a detailed description of all *WMS Decorations* for layouts see:                                                                                                                                                                                                                                                            |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - <http://docs.geoserver.org/latest/en/user/services/wms/decoration.html>                                                                                                                                                                                                                                                        |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | -In order to display the year, month or date each frame represents include the text decoration:                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - value=\"\${avalue}\"                                                                                                                                                                                                                                                                                                           |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **9.a**  | In order to render a legend that doesn't also include the basemap, it may be best to include a GetLegend Graphic call as an image decoration in the xml file.                                                                                                                                                                                                                                                                                | -Instructions on how to format a get legend graphic:                                                                                                                                                                                                                                                                             |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - http://docs.geoserver.org/2.7.0/user/services/wms/get_legend_graphic/legendgraphic.html                                                                                                                                                                                                                                        |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **10**   | Now that all the necessary elements are completed, the WMS Animator get map request can be composed. Through the get map request, the layer group is called, the bounding box, width and height are set, the dates of interest are specified and the layout xml file is referred to.                                                                                                                                                         | -For a detailed overview of the WMS Animator function:                                                                                                                                                                                                                                                                           |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          | Depending on the style chosen and the number of frames requested, the load time can be lengthy. By altering certain attributes of the style, load time can be shorted.                                                                                                                                                                                                                                                                       | - http://docs.geoserver.org/stable/en/user/tutorials/animreflector.html                                                                                                                                                                                                                                                          |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | -Example of a completed request:                                                                                                                                                                                                                                                                                                 |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                  |
|          |                                                                                                                                                                                                                                                                                                                                                                                                                                              | - http://localhost:8080/geoserver/lighthouse/wms/animate?layers=lighthouse:BC_Coastal_lighthouses&styles=&bbox=-137.05,46.7,-117,55.8&width=750&height=500&aparam=time&avalues=1936, 1946,1956,1966,1976,1986,1996,2006,2012&format=image/gif;subtype=animated&format_options=layout:lighthouse_layout;gif_loop_continuosly:true |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **11**   | If your animation displays, your get map request is composed correctly. If not make adjustments as necessary, referring to the GeoServer WMS Animator page for help. Make adjustments to the layout and style as needed.                                                                                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                  |
+----------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
