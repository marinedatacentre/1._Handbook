**Purpose:**

To create an animation using GeoServer that employs the time dimension
capability of a layer, while pulling data from a PostGIS database. The
final result is a gif created through a get map request, showing the
change of a selected attribute over time.

+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Step** | **Major Activity**         | **References, Forms and Details**                                                                                                                                                    |
+:========:+============================+======================================================================================================================================================================================+
| **1**    | In GeoServer create an     | -Documentation on GeoServer processes, such as creating workspaces, can be found at the official GeoServer website:                                                                  |
|          | appropriately named        |                                                                                                                                                                                      |
|          | *workspace* with WMS       | - http://docs.geoserver.org/latest/en/user/index.html                                                                                                                                |
|          | services enabled.          |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2**    | Create a new *store* from  | - Mandatory fields to fill for the new *store* are:                                                                                                                                  |
|          | a PostGIS data source in   |                                                                                                                                                                                      |
|          | GeoServer and call it the  |   - Workspace                                                                                                                                                                        |
|          | same thing as the PostGIS  |                                                                                                                                                                                      |
|          | table from which it is     |   - dbtype                                                                                                                                                                           |
|          | pulling. (If you do not    |                                                                                                                                                                                      |
|          | have a PostGIS table with  |   - host                                                                                                                                                                             |
|          | a time enabled date column |                                                                                                                                                                                      |
|          | follow steps 2a and 2b,    |   - port                                                                                                                                                                             |
|          | otherwise proceed to step  |                                                                                                                                                                                      |
|          | 3.)                        |   - database                                                                                                                                                                         |
|          |                            |                                                                                                                                                                                      |
|          | \*Alternatively a *store*  |   - schema                                                                                                                                                                           |
|          | can be created from a      |                                                                                                                                                                                      |
|          | shapefile instead of a     |   - user                                                                                                                                                                             |
|          | PostGIS table, as long as  |                                                                                                                                                                                      |
|          | there is a column of type  |   - passwd                                                                                                                                                                           |
|          | 'date'.                    |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2.a**  | If you are starting from a | - This is necessary information for GeoServer's WMS Animator .                                                                                                                       |
|          | points shapefile with date |                                                                                                                                                                                      |
|          | information, the date      | - A 'date' field can be created using the field calculator in ArcGIS and QGIS.                                                                                                       |
|          | column must be of type     |                                                                                                                                                                                      |
|          | 'date'.                    |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2.b**  | Your shapefile can be then | -View the following website to see the necessary command:                                                                                                                            |
|          | be imported into a         |                                                                                                                                                                                      |
|          | spatially enabled PostGIS  | - http://suite.opengeo.org/docs/latest/dataadmin/pgGettingStarted/shp2pgsql.html                                                                                                     |
|          | database through the       |                                                                                                                                                                                      |
|          | command line.              |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **3**    | If the PostGIS table was   | - The time dimension will only be allowed to be enabled as long as the PostGIS table or shapefile has a column of type 'date'.                                                       |
|          | successfully connected     |                                                                                                                                                                                      |
|          | through the new store, the |                                                                                                                                                                                      |
|          | option to publish the      |                                                                                                                                                                                      |
|          | desired table will become  |                                                                                                                                                                                      |
|          | an option. Publish the     |                                                                                                                                                                                      |
|          | layer, name it something   |                                                                                                                                                                                      |
|          | appropriate and set the    |                                                                                                                                                                                      |
|          | Declared SRS to EPSG:4326. |                                                                                                                                                                                      |
|          | For the bounding box       |                                                                                                                                                                                      |
|          | select 'compute from data' |                                                                                                                                                                                      |
|          | and 'compute from native   |                                                                                                                                                                                      |
|          | bounds'. Under the         |                                                                                                                                                                                      |
|          | *Dimensions* tab of the    |                                                                                                                                                                                      |
|          | layer, enable Time, set    |                                                                                                                                                                                      |
|          | the *Attribute* to the     |                                                                                                                                                                                      |
|          | date column and the        |                                                                                                                                                                                      |
|          | *Presentation* to List.    |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **4**    | Test that your layer is    | -Official GeoServer website:                                                                                                                                                         |
|          | working by selecting it in |                                                                                                                                                                                      |
|          | *layer preview*. Select a  | - http://docs.geoserver.org/latest/en/user/index.html                                                                                                                                |
|          | point to see its           |                                                                                                                                                                                      |
|          | attributes. If the layer   |                                                                                                                                                                                      |
|          | is not showing refer back  |                                                                                                                                                                                      |
|          | to the previous steps,     |                                                                                                                                                                                      |
|          | using the GeoServer        |                                                                                                                                                                                      |
|          | website for more in depth  |                                                                                                                                                                                      |
|          | information.               |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **5**    | Create a store and layer   | - Rather than a PostGIS table it may be a shapefile.                                                                                                                                 |
|          | for the raster or vector   |                                                                                                                                                                                      |
|          | layer you wish to use as a | - Dimensions do not have to be set.                                                                                                                                                  |
|          | basemap in the animation.  |                                                                                                                                                                                      |
|          | Follow the same procedure  |                                                                                                                                                                                      |
|          | for the coordinate system  |                                                                                                                                                                                      |
|          | and bounding box.          |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **6**    | In GeoServer, create the   | - Examples of styles include rendering transformations (Barnes Surface, Heatmaps) and categorize.                                                                                    |
|          | *style* you wish to use    |                                                                                                                                                                                      |
|          | for the animation. The     | - Rendering transformations - <http://docs.geoserver.org/2.2.0/user/styling/sld-extensions/rendering-transform.html>                                                                 |
|          | style should be selected   |                                                                                                                                                                                      |
|          | based on what you think    | - Categorize - http://docs.geoserver.org/2.3.2/user/styling/sld-tipstricks/transformation-func.html                                                                                  |
|          | the best way to represent  |                                                                                                                                                                                      |
|          | the data is. The GeoServer |                                                                                                                                                                                      |
|          | website provides a range   |                                                                                                                                                                                      |
|          | of examples. Set the       |                                                                                                                                                                                      |
|          | format to SLD (or download |                                                                                                                                                                                      |
|          | the YSLD extension for     |                                                                                                                                                                                      |
|          | simplified coding), and    |                                                                                                                                                                                      |
|          | alter the selected styles  |                                                                                                                                                                                      |
|          | color ramp and attributes  |                                                                                                                                                                                      |
|          | as needed.                 |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **7**    | Create an appropriately    | - If you want the styled layer to appear below the basemap, ensure the basemap is at the bottom of the drawing order.                                                                |
|          | named *Layer Group*. Add   |                                                                                                                                                                                      |
|          | the layer with the         |                                                                                                                                                                                      |
|          | attributes of interest and |                                                                                                                                                                                      |
|          | set its style to the one   |                                                                                                                                                                                      |
|          | you have created. Add the  |                                                                                                                                                                                      |
|          | basemap layer and compute  |                                                                                                                                                                                      |
|          | the bounding box as with   |                                                                                                                                                                                      |
|          | the individual layers.     |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **8**    | Use *layer preview* to     | -The time dimension can be tested by adding '&time=' with a date, year or month at the end of the layer preview url.                                                                 |
|          | test that your layer group |                                                                                                                                                                                      |
|          | is rendered effectively.   | - Ex/ &time=1989                                                                                                                                                                     |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **9**    | In order to add layout     | -For a detailed description of all *WMS Decorations* for layouts see:                                                                                                                |
|          | elements such as a title,  |                                                                                                                                                                                      |
|          | legend and scale to the    | - <http://docs.geoserver.org/latest/en/user/services/wms/decoration.html>                                                                                                            |
|          | animation, a layout xml    |                                                                                                                                                                                      |
|          | file has to be created. If | -In order to display the year, month or date each frame represents include the text decoration:                                                                                      |
|          | using an independent       |                                                                                                                                                                                      |
|          | version of GeoServer, the  | - value=\"\${avalue}\"                                                                                                                                                               |
|          | layout xml folder goes in  |                                                                                                                                                                                      |
|          | the 'layouts'              |                                                                                                                                                                                      |
|          | sub-directory. If using a  |                                                                                                                                                                                      |
|          | version of GeoServer       |                                                                                                                                                                                      |
|          | bundled with GeoNetwork,   |                                                                                                                                                                                      |
|          | create a layouts folder in |                                                                                                                                                                                      |
|          | the 'data' sub-directory   |                                                                                                                                                                                      |
|          | of GeoServer.              |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **9.a**  | In order to render a       | -Instructions on how to format a get legend graphic:                                                                                                                                 |
|          | legend that doesn't also   |                                                                                                                                                                                      |
|          | include the basemap, it    | - http://docs.geoserver.org/2.7.0/user/services/wms/get_legend_graphic/legendgraphic.html                                                                                            |
|          | may be best to include a   |                                                                                                                                                                                      |
|          | GetLegend Graphic call as  |                                                                                                                                                                                      |
|          | an image decoration in the |                                                                                                                                                                                      |
|          | xml file.                  |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **10**   | Now that all the necessary | -For a detailed overview of the WMS Animator function:                                                                                                                               |
|          | elements are completed,    |                                                                                                                                                                                      |
|          | the WMS Animator get map   | - http://docs.geoserver.org/stable/en/user/tutorials/animreflector.html                                                                                                              |
|          | request can be composed.   |                                                                                                                                                                                      |
|          | Through the get map        | -Example of a completed request:                                                                                                                                                     |
|          | request, the layer group   |                                                                                                                                                                                      |
|          | is called, the bounding    | - http://localhost:8080/geoserver/lighthouse/wms/animate?layers=lighthouse:BC_Coastal_lighthouses&styles=&bbox=-137.05,46.7,-117,55.8&width=750&height=500&aparam=time&avalues=1936, |
|          | box, width and height are  |   1946,1956,1966,1976,1986,1996,2006,2012&format=image/gif;subtype=animated&format_options=layout:lighthouse_layout;gif_loop_continuosly:true                                        |
|          | set, the dates of interest |                                                                                                                                                                                      |
|          | are specified and the      |                                                                                                                                                                                      |
|          | layout xml file is         |                                                                                                                                                                                      |
|          | referred to.               |                                                                                                                                                                                      |
|          |                            |                                                                                                                                                                                      |
|          | Depending on the style     |                                                                                                                                                                                      |
|          | chosen and the number of   |                                                                                                                                                                                      |
|          | frames requested, the load |                                                                                                                                                                                      |
|          | time can be lengthy. By    |                                                                                                                                                                                      |
|          | altering certain           |                                                                                                                                                                                      |
|          | attributes of the style,   |                                                                                                                                                                                      |
|          | load time can be shorted.  |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **11**   | If your animation          |                                                                                                                                                                                      |
|          | displays, your get map     |                                                                                                                                                                                      |
|          | request is composed        |                                                                                                                                                                                      |
|          | correctly. If not make     |                                                                                                                                                                                      |
|          | adjustments as necessary,  |                                                                                                                                                                                      |
|          | referring to the GeoServer |                                                                                                                                                                                      |
|          | WMS Animator page for      |                                                                                                                                                                                      |
|          | help. Make adjustments to  |                                                                                                                                                                                      |
|          | the layout and style as    |                                                                                                                                                                                      |
|          | needed.                    |                                                                                                                                                                                      |
+----------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
